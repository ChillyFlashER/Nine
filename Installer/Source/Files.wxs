<?xml version="1.0" encoding="UTF-8"?>
<?include "Config.wxi"?>

<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Fragment>

    <DirectoryRef Id="TARGETDIR">
      <Directory Id="ProgramMenuFolder" Name="ProgramMenuFolder">
        <Directory Id="ProductProgramMenuFolder" Name="$(var.ProductName)">
          <Component Id="ShortcutComponent" Guid="AC9ED70C-6BD9-4E06-A933-30A7E815DFE2">
            <File Id="OnlineShortcut" Name="$(var.ProductName) Online.url" Source="$(sys.SOURCEFILEDIR)../UI/Engine Nine Online.url" />
            <RemoveFolder Id="ProductProgramMenuFolder" On="uninstall"/>
            <RegistryValue Root="HKCU" Key="Software\$(var.ProductName)\v$(var.ProductVersion)\ShortCuts" Name="Website" Type="integer" Value="1" KeyPath="yes"/>
          </Component>

          <Component Id="SamplesShortcutComponent" Guid="CD8A58E2-AE3D-4DB4-97DE-11753290D459">
            <RegistryValue Root="HKCU" Key="Software\$(var.ProductName)\v$(var.ProductVersion)\ShortCuts" Name="Samples" Type="integer" Value="1" KeyPath="yes"/>
            <Shortcut Id="SamplesShortcut" Name="Browse Samples" Target="[dir4268DA91D53F8A48E3F86149716D52F6]" />
          </Component>
        </Directory>
      </Directory>

      <Directory Id="ProgramFilesFolder" Name="PFiles">
        <Directory Id="INSTALLDIR" Name="$(var.ProductName)">
          <Directory Id="ProductDir" Name="v$(var.ProductVersion)">
            <Component Id="LicenseComponent" Guid="8846E0EA-2C5B-464F-8094-DFC16AEB05F1">
              <File Id="License" Name="License.txt" Source="$(sys.SOURCEFILEDIR)../../License.txt" KeyPath="yes" />
            </Component>
            
            <Component Id="EnvironmentVarComponent" Guid="FA050AA6-9DEF-4364-ABBD-7B233F06E1BA">
              <CreateFolder />
              <Environment Id="Nine" Action="set" Part="all" Name="Nine$(var.ProductCompactVersion)" Permanent="no" System="yes" Value="[ProductDir]" />
            </Component>
          </Directory>
        </Directory>
      </Directory>
    </DirectoryRef>
    
  </Fragment>
</Wix>
